# ğŸ‰ [gen_model](https://github.com/KonshinHaoshin/gen_model)

> å¦‚æœä½ è§‰å¾—è¿™ä¸ªå·¥å…·å¯¹ä½ æœ‰å¸®åŠ©ï¼Œæ¬¢è¿å…³æ³¨ B ç«™ UP ä¸» **ä¸œå±±ç‡ƒç¯å¯º**ï¼  
> ğŸ’– ä½ çš„æ”¯æŒæ˜¯æˆ‘æŒç»­æ”¹è¿›çš„åŠ¨åŠ›ï¼  
> ğŸ”— B ç«™é“¾æ¥ï¼š[https://space.bilibili.com/296330875](https://space.bilibili.com/296330875?spm_id_from=333.1007.0.0)

âœ¨ æœ¬é¡¹ç›®æ˜¯ä¸€ä¸ªä¸“ä¸º **Live2D Cubism 2 SDK æ¨¡å‹** å¼€å‘çš„èµ„æºç®¡ç†ä¸è‡ªåŠ¨åŒ–å·¥å…·ï¼Œå¸®åŠ©ç”¨æˆ·è½»æ¾åˆ›å»ºã€æ›´æ–°å¹¶æ‰¹é‡æ•´ç† `model.json` é…ç½®æ–‡ä»¶ï¼Œæå¤§åœ°å‡å°‘æ‰‹åŠ¨ç¼–è¾‘è´Ÿæ‹…ã€‚

> âš ï¸ æœ¬å·¥å…·**ä»…æ”¯æŒ Cubism 2 æ—¶ä»£çš„æ¨¡å‹ç»“æ„**ã€‚

---

## ğŸ”¥ ä¸»è¦åŠŸèƒ½

### 1. âœ… ç”Ÿæˆ `model.json`

- è‡ªåŠ¨æ‰«ææŒ‡å®šçš„ Live2D æ¨¡å‹ç›®å½•ï¼Œç”Ÿæˆæ ‡å‡†æ ¼å¼çš„ `model.json`ã€‚
- è‡ªåŠ¨åˆ†ç±»å¹¶å¯¼å…¥ï¼š
  - `.moc` æ¨¡å‹æ–‡ä»¶
  - `.physics.json` ç‰©ç†é…ç½®
  - `.png` è´´å›¾çº¹ç†
  - `.mtn` åŠ¨ä½œ
  - `.exp.json` è¡¨æƒ…æ–‡ä»¶

### 2. â• æ·»åŠ å•ä¸ªåŠ¨ä½œæˆ–è¡¨æƒ…

- å‘å·²æœ‰çš„ `model.json` æ·»åŠ å•ä¸ª `.mtn` æˆ– `.exp.json` æ–‡ä»¶ã€‚
- è‡ªåŠ¨è·¯å¾„ç›¸å¯¹åŒ–ï¼Œæ–¹ä¾¿è·¨å¹³å°ä½¿ç”¨ã€‚

### 3. ğŸ“¦ æ‰¹é‡æ·»åŠ åŠ¨ä½œæˆ–è¡¨æƒ…

- æ”¯æŒè¾“å…¥ä¸€ä¸ªæ–‡ä»¶å¤¹æˆ–å¤šä¸ªæ–‡ä»¶è·¯å¾„ï¼ˆç”¨ `;` åˆ†éš”ï¼‰è¿›è¡Œæ‰¹é‡å¯¼å…¥ã€‚
- å¯è‡ªå®šä¹‰åç§°å‰ç¼€ï¼Œä¾¿äºç»„ç»‡ç®¡ç†ã€‚

### 4. ğŸ§¹ å»é‡ + åˆ é™¤æ— æ•ˆè·¯å¾„ï¼ˆå…¨æ–°åŠŸèƒ½ï¼ï¼‰

- è‡ªåŠ¨æ£€æµ‹å¹¶å»é‡ `model.json` ä¸­çš„é‡å¤åŠ¨ä½œ/è¡¨æƒ…ã€‚
- è‡ªåŠ¨æ£€æµ‹æ–‡ä»¶æ˜¯å¦å®é™…å­˜åœ¨ï¼Œ**é›†ä¸­åˆ—å‡ºæ‰€æœ‰ç¼ºå¤±é¡¹**ï¼Œå¹¶è¯¢é—®æ˜¯å¦ä¸€é”®åˆ é™¤å¯¹åº”è®°å½•ã€‚
- è‡ªåŠ¨å¤‡ä»½åŸå§‹ `model.json` ä¸º `.bak` æ–‡ä»¶ã€‚

### 5. ğŸ›  æ‰¹é‡ä¿®æ”¹ `.mtn` æ–‡ä»¶ä¸­çš„ `PARAM_IMPORT` å‚æ•°

- å¿«é€Ÿæ›¿æ¢æŒ‡å®šç›®å½•ä¸‹æ‰€æœ‰ `.mtn` æ–‡ä»¶ä¸­çš„ `PARAM_IMPORT` å€¼ï¼Œç”¨äºè°ƒæ•´åŠ¨ä½œæƒé‡æˆ–åˆæˆè¡Œä¸ºã€‚

---

## ğŸš€ ä½¿ç”¨æ–¹æ³•

1. **è¿è¡Œ `live2d_tool.py`**ï¼š

   ```bash
   python live2d_tool.py
   ```

2. **æ ¹æ®èœå•æç¤ºé€‰æ‹©åŠŸèƒ½**ï¼š

   ```
   1. ç”Ÿæˆæ–°çš„ model.json
   2. æ·»åŠ å•ä¸ªåŠ¨ä½œ/è¡¨æƒ…åˆ° model.json
   3. æ‰¹é‡æ·»åŠ åŠ¨ä½œ/è¡¨æƒ…åˆ° model.json
   4. å»é‡ model.json ä¸­é‡å¤çš„åŠ¨ä½œ/è¡¨æƒ…ï¼Œå¹¶åˆ é™¤ä¸å­˜åœ¨çš„è·¯å¾„
   5. æ‰¹é‡æ›´æ”¹ mtn æ–‡ä»¶ä¸­çš„ PARAM_IMPORT å‚æ•°
   q. é€€å‡ºç¨‹åº
   ```

3. **æŒ‰ç…§æç¤ºè¾“å…¥æ–‡ä»¶è·¯å¾„ã€å‚æ•°ç­‰ä¿¡æ¯**ï¼Œç­‰å¾…ç¨‹åºæ‰§è¡Œå®Œæˆã€‚

---

## ğŸ“‚ æ¨èæ–‡ä»¶ç»“æ„ï¼ˆç¤ºä¾‹ï¼‰

```
your_model_folder/
â”œâ”€â”€ model.moc
â”œâ”€â”€ model.json
â”œâ”€â”€ physics.json
â”œâ”€â”€ texture_00.png
â”œâ”€â”€ idle.mtn
â”œâ”€â”€ happy.exp.json
â””â”€â”€ ...
```

---

## ğŸ’¡ å°è´´å£«

- ä½¿ç”¨å‰è¯·å¤‡ä»½æ¨¡å‹ç›®å½•ï¼Œé¿å…è¯¯æ“ä½œã€‚
- å·¥å…·é»˜è®¤ä¼šå¯¹ `model.json` è¿›è¡Œ `.bak` å¤‡ä»½ï¼Œæ”¾å¿ƒä¿®æ”¹ã€‚
- å»ºè®®åœ¨æ¨¡å‹åˆ¶ä½œåæœŸä½¿ç”¨æœ¬å·¥å…·è¿›è¡Œèµ„æºæ•´ç†ä¸æ‰¹é‡ä¿®å¤ã€‚

## ğŸ¨ æ–°åŠŸèƒ½ï¼š`color_transfer.py` â€” å›¾åƒè‰²è°ƒåŒ¹é… & WebGAL è‰²è°ƒæŒ‡ä»¤ç”Ÿæˆ

> å¿«é€Ÿå°†ä¸€å¼ å›¾åƒçš„æ•´ä½“è‰²è°ƒè¿ç§»ä¸ºå¦ä¸€å¼ å›¾åƒçš„é£æ ¼ï¼Œå¹¶è‡ªåŠ¨ç”Ÿæˆ WebGAL ä½¿ç”¨çš„ `setTransform` æŒ‡ä»¤ï¼

------

### ğŸ”§ åŠŸèƒ½ä»‹ç»

- å¯¹æ¯”æºå›¾ä¸å‚è€ƒå›¾çš„ RGB è‰²å½©åˆ†å¸ƒï¼Œè‡ªåŠ¨ç”Ÿæˆâ€œåŒ¹é…é£æ ¼â€çš„æ–°å›¾åƒã€‚
- è‡ªåŠ¨æ„é€  WebGAL æŒ‡ä»¤ï¼šæ ¹æ®å‚è€ƒå›¾ç›¸å¯¹äºæºå›¾çš„äº®åº¦å·®å¼‚ï¼Œç”Ÿæˆç²¾ç¡®çš„ `colorRed` / `colorGreen` / `colorBlue` å‚æ•°ã€‚
- æ”¯æŒäº¤äº’å¼é€‰æ‹©å›¾åƒï¼Œè¾“å‡ºå›¾åƒè‡ªåŠ¨ä¿å­˜å¹¶å¯è§†åŒ–é¢„è§ˆã€‚

------

### ğŸ“¦ ä½¿ç”¨æ–¹å¼

1. å°†æºå›¾åƒï¼ˆéœ€è¦è°ƒæ•´é£æ ¼ï¼‰å‡†å¤‡å¥½ï¼›

2. å°†å‚è€ƒå›¾åƒæ”¾å…¥ `png/` æ–‡ä»¶å¤¹ï¼ˆæ”¯æŒå¤šä¸ª .pngï¼‰ï¼›

3. è¿è¡Œå®‰è£…ä¾èµ–

   ```bash
   pip install pillow numpy matplotlib
   ```

4. è¿è¡Œ

   ```bash
   python color_transfer.py
   ```

5. æŒ‰ç…§å‘½ä»¤è¡Œæç¤ºæ“ä½œï¼š

6. ç¨‹åºå°†è¾“å‡ºï¼š

   - ä¸€å¼ æ–°çš„è‰²è°ƒåŒ¹é…å›¾ï¼šä¿å­˜åœ¨ `output/` æ–‡ä»¶å¤¹ä¸­ï¼›
   - ä¸€æ¡ WebGAL å¯ç”¨çš„ `setTransform` æŒ‡ä»¤ï¼Œç›´æ¥å¤åˆ¶ä½¿ç”¨ã€‚

### ğŸ“Œ ç¤ºä¾‹è¾“å‡º

```bash
âœ… Color matching done. Saved to: output/matched_background_cool.png

ğŸ¬ Suggested WebGAL Transform Command:
setTransform:{"colorRed": 130, "colorGreen": 210, "colorBlue": 255} -target=bg-main -duration=0 -next;
```

### ğŸ”„ æ•°å­¦åŸç†ï¼š**æ ‡å‡†åŒ– + åˆ†å¸ƒè½¬æ¢**

è¿™ä¸€æ­¥æ˜¯æ ¸å¿ƒï¼š

1. å°†æºå›¾çš„æ¯ä¸ªåƒç´ å…ˆæ ‡å‡†åŒ–ä¸º **é›¶å‡å€¼å•ä½æ–¹å·®**

   ```math
   z=xâˆ’Î¼srcÏƒsrcz = \frac{x - \mu_{\text{src}}}{\sigma_{\text{src}}}z=Ïƒsrcxâˆ’Î¼src
   ```

   

   

2. å†é‡æ„ä¸ºç›®æ ‡å›¾çš„åˆ†å¸ƒï¼š

   ```math
   xnew=zâ‹…Ïƒtgt+Î¼tgtx_{\text{new}} = z \cdot \sigma_{\text{tgt}} + \mu_{\text{tgt}}xnew=zâ‹…Ïƒtgt+Î¼tgt
   ```

   

è¿™ç›¸å½“äºå°†æºå›¾çš„è‰²å½©åˆ†å¸ƒâ€œå¹³ç§»+æ‹‰ä¼¸â€ä¸ºå‚è€ƒå›¾çš„è‰²å½©åˆ†å¸ƒã€‚

å³å¯¹æ¯ä¸ª RGB é€šé“ï¼š

- å°†æºå›¾åƒçš„äº®åº¦â€œæ‹‰å¹³â€ä¸ºæ ‡å‡†åˆ†å¸ƒï¼›
- ç„¶åå†â€œæ‹‰å›â€æˆç›®æ ‡å›¾çš„é£æ ¼ã€‚

 ğŸ§  WebGAL è‰²è°ƒåˆ†æï¼š

æ¯ä¸ªé€šé“ï¼ˆR/G/Bï¼‰é»˜è®¤å€¼ä¸º `255`ï¼Œç¨‹åºå°†æ ¹æ®å‚è€ƒå›¾çš„ç›¸å¯¹äº®åº¦å˜åŒ–ä¸æºå›¾è¿›è¡Œå¯¹æ¯”ï¼Œè¾“å‡ºï¼š

```python
colorX = 255 - (source_mean - target_mean)
```

å¹¶ä¿è¯ç»“æœèŒƒå›´åœ¨ `[0, 255]`ï¼Œè‡ªåŠ¨å‘ WebGAL æ ·å¼é æ‹¢ã€‚

### âœ… ç¤ºä¾‹

![1](readme/1.png)

![2](readme/2.png)

![3](readme/3.png)

> ```webgal
> changeBg:Eï¼ˆlive houseï¼‰/E6.png;
> setTransform:{"colorRed": 139, "colorGreen": 174, "colorBlue": 204} -target=bg-main -duration=0 -next;
> ```

![4](readme/4.png)

## ğŸ“œ License

æœ¬é¡¹ç›®éµå¾ª MIT åè®®ï¼Œæ¬¢è¿è‡ªç”±ä½¿ç”¨ã€ä¿®æ”¹å’Œåˆ†å‘ã€‚

---

å¦‚éœ€è‡ªåŠ¨åŒ–è„šæœ¬ã€å›¾å½¢ç•Œé¢æˆ–ä¸ Live2D Viewer é…å¥—ä½¿ç”¨çš„åŠŸèƒ½ï¼Œæ¬¢è¿å‘èµ· Issue æˆ– PRï¼  
æœ‰æ›´å¤šæƒ³æ³•ä¹Ÿæ¬¢è¿è”ç³»æˆ‘ï¼Œæˆ‘ä¼šæŒç»­ç»´æŠ¤å’Œä¼˜åŒ–ã€‚




```bash
 pyinstaller -w -F main_ui.py --icon=icon.ico --name Live2DToolbox --add-data "style.qss;." --add-data "icon.png;."                                  
                                                                                    
```